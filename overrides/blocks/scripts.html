{#- can't enforce HTTPS because kaillera clients cannot access server lists over HTTPS -#}
<script>(function (url, hostname, param, value) { if (url.protocol !== 'https:' && url.hostname === hostname && url.searchParams.get(param) != value) { url.protocol = 'https:'; url.searchParams.set(param, value); location.replace(url) } })(new URL(location), '{{ config.extra.site_domain }}', 's', 1)</script>
{#- refresh the page if we use navigation.instant and move between sections -#}
<script>(function (config, content, key) { if (document.querySelectorAll(config).length > 0) { const features = JSON.parse(document.querySelectorAll(config)[0].innerHTML).features; if (! features.includes('navigation.instant')) { return; } if (document.querySelectorAll(content).length > 0) { section = document.querySelectorAll(content)[0].attributes[key].value; if (section != localStorage.section) { localStorage.section = section; window.location.reload(true); } localStorage.section = section; } } })('#__config', '#__content', 'section');</script>
{#- can't enforce HTTPS because kaillera clients cannot access server lists over HTTPS -#}
<script>(function (url, hostname, param, value) { if (url.protocol !== 'https:' && url.hostname === hostname && url.searchParams.get(param) != value) { url.protocol = 'https:'; url.searchParams.set(param, value); location.replace(url) } })(new URL(location), '{{ config.extra.site_domain }}', 's', 1)</script>
{#- cache the service workers for the ROM patcher #}
<script>(function (hostname, register, scope) { if (location.protocol === 'https:' && 'serviceWorker' in navigator && window.location.hostname === hostname) { navigator.serviceWorker.register(register, {scope: scope}); } })('{{ config.extra.site_domain }}', '{{ "assets/javascripts/_cache_service_worker.js" | url }}', '/assets/javascripts/')</script>
